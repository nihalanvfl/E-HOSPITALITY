<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Appointments</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container mt-5">
  <h3 class="mb-4 text-center">ðŸ“… Available Appointments</h3>
  <div class="row">
    {% for appt in appointments %}
    <div class="col-md-4 mb-4">
      <div class="card p-3 shadow-sm">
        <h5>{{ appt.doctor.user.username }}</h5>
        <p><b>Date:</b> {{ appt.date }} | <b>Time:</b> {{ appt.time }}</p>
        <p><b>Location:</b> {{ appt.location_name }}</p>
        <p><b>Fee:</b> ${{ appt.fee }}</p>
        <p><b>Available Slots:</b> {{ appt.available_slots }}</p>

        {% if appt.patients.all|length >= appt.total_slots %}
          <button class="btn btn-secondary w-100" disabled>No Slots</button>
        {% elif patient in appt.patients.all %}
          <button class="btn btn-success w-100" disabled>âœ… You booked this</button>
        {% else %}
          <a href="{% url 'pay_appointment' appt.id %}" class="btn btn-primary w-100">Book</a>
        {% endif %}
      </div>
    </div>
    {% empty %}
      <p>No appointments available.</p>
    {% endfor %}
  </div>
</div>
</body>
</html>
